<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RAKUTEKU｜最安値名入れボールペン簡単注文</title>
  <meta name="description" content="名入れボールペンの注文を承り中です。">
  <link rel="stylesheet" href="/rakuteku.css">
  <link rel="stylesheet" href="/prodDesc.css">
  <link rel="stylesheet" href="/naire.css">
  <link rel="stylesheet" href="/category.css">
  <link rel="icon" type="image/png" href="/img/logoFavIcon.png">
</head>
<body>
  <!--NAVBAR-->
  <nav style="box-shadow:none; background-color: black;">
    <div class="logo">
      <img src="/img/logoFavIcon.png" alt="logo" />
      <h1>RAKUTEKU</h1>
    </div>
    <ul>
      <li>
        <a href="/" style="color:white">ホーム</a>
      </li>
      <li>
        <a href="#" style="color:white">会社概要</a>
      </li>
      <li>
        <a href="#shouhinIchiran" onclick="event.preventDefault(); document.getElementById('shouhinIchiran').scrollIntoView({ behavior: 'smooth' });" style="color:white">
          商品一覧
        </a>
      </li>
      <li>
        <a href="#" onclick="openModal(); return false;" style="color:white">お問い合わせ</a>
      </li>
    </ul>
    <div class="hamburger">
      <span class="line" style="background-color: white;"></span>
      <span class="line" style="background-color: white;"></span>
      <span class="line" style="background-color: white;"></span>
    </div>
  </nav>
  <div class="menubar">
    <ul>
      <li>
        <a href="/">ホーム</a>
      </li>
      <li>
        <a href="#">会社概要</a>
      </li>
      <li>
        <a href="#shouhinIchiran" onclick="event.preventDefault(); document.getElementById('shouhinIchiran').scrollIntoView({ behavior: 'smooth' });">
          商品一覧
        </a>
      </li>
      <li>
        <a href="#" onclick="openModal(); return false;">お問い合わせ</a>
      </li>
    </ul>
  </div>

    <!-- Breadcrumb -->
    <div class="breadcrumb" style="background-color: rgba(0,0,0,0.2);padding: 4px;border-radius: 4px;position: sticky;">
      <a href="/">Home</a> &gt;
      <a href="/naire/borupen-eng.html" >Logo Print</a> &gt;
      M3001 | 
      <a href="/naire/detail-m3001.html" >日本語</a>
    </div>

<!-- DETAIL -->
<div class="naire-detail-container">
    <div class="gallery">
        <img id="mainImg" class="gallery-main" src="/img/naire/oem-logo-3-desc-a.jpg" alt="商品画像" />
        <div class="thumbnails">
          <img src="/img/naire/oem-logo-3-desc-a.jpg" data-full="/img/naire/oem-logo-3-desc-a.jpg" class="active" />
          <img src="/img/naire/oem-logo-3-desc-b.jpg" data-full="/img/naire/oem-logo-3-desc-b.jpg" />
          <img src="/img/naire/oem-logo-3-desc-c.jpg" data-full="/img/naire/oem-logo-3-desc-c.jpg" />
          <img src="/img/naire/oem-logo-3-desc-d.jpg" data-full="/img/naire/oem-logo-3-desc-d.jpg" />
          <img src="/img/naire/oem-logo-3-desc-e.jpg" data-full="/img/naire/oem-logo-3-desc-e.jpg" />
        </div>
        <div class="info-tabs">
          <div class="tab-headers">
            <button class="tab-button active" data-tab="pricing">Pricing</button>
            <button class="tab-button" data-tab="product">Specification</button>
            <button class="tab-button" data-tab="design">About Design</button>
            <button class="tab-button" data-tab="order">How to Order</button>
          </div>
          <div class="tab-content active" id="pricing">
            <table class="tab-table">
              <tr>
                <th>Price (with tax)</th>
                <td>50pcs ¥10,900 (@218円)<br>100pcs ¥11,900 (@119円)</td>
              </tr>
              <tr>
                <th>delivery fee</th>
                <td>※Free delivery fee for whole Japan.</td>
              </tr>
            </table>
          </div>
          <div class="tab-content" id="product">
            <table class="tab-table">
              <tr>
                <th>Material</th>
                <td>Plastic</td>
              </tr>
              <tr>
                <th>Size</th>
                <td>139mm × Φ11.3mm</td>
              </tr>
              <tr>
                <th>Pen tip Diameter</th>
                <td>0.5mm</td>
              </tr>
              <tr>
                <th>Body Color</th>
                <td>Black or White</td>
              </tr>
              <tr>
                <th>Pen Ink Color</th>
                <td>black, blue, and red</td>
              </tr>
            </table>
          </div>
          <div class="tab-content" id="design">
            <table class="tab-table">
              <tr>
                <th>Logo Color</th>
                <td>
                  1-color<br/>
                  ＊Additional color will cost an additional 2,000 yen.
                </td>
              </tr>
              <tr>
                <th>Logo printing range</th>
                <td>
                  Please check the photos below<br/>
                  <img src="/img/naire/oem-logo-3-desc-b-crop.jpg" data-full="/img/naire/oem-logo-3-desc-b-crop.jpg" style="max-width: 270px;"/>
                </td>
              </tr>
              <tr>
                <th>Delivery time</th>
                <td>
                  2-3 weeks
                  ＊After the order is confirmed
                </td>
              </tr>
            </table>
          </div>
          <div class="tab-content" id="order">
            <table class="tab-table">
              <tr>
                <th><img src="/img/naire/flow-a.png" data-full="/img/naire/flow-a.png" style="max-width: 150px;border-radius: 4px;"/></th>
                <td>
                  <strong>STEP 1 Select a product</strong><br/>
                  ＊Please check the product specifications, body color, and ink color.
                </td>
              </tr>
              <tr>
                <th><img src="/img/naire/flow-b.png" data-full="/img/naire/flow-b.png" style="max-width: 150px;border-radius: 4px;"/></th>
                <td>
                  <strong>STEP 2　Online Order</strong><br/>
                  ＊Please submit the order form on this page.<br/>
                  ＊Once you submit the form, you will receive an automated email.
                </td>
              </tr>
              <tr>
                <th><img src="/img/naire/flow-c.png" data-full="/img/naire/flow-c.png" style="max-width: 150px;border-radius: 4px;"/></th>
                <td>
                  <strong>STEP 3　Confirmation Email</strong><br/>
                  ＊The person in charge will confirm the stock, design, logo, etc.<br/>
                  ＊Payment instructions and an invoice will also be sent to you by email.
                </td>
              </tr>
              <tr>
                <th><img src="/img/naire/flow-d.png" data-full="/img/naire/flow-d.png" style="max-width: 150px;border-radius: 4px;"/></th>
                <td>
                  <strong>STEP 4　Payment</strong><br/>
                  ＊Please pay by bank transfer or PAYPAY.
                </td>
              </tr>
              <tr>
                <th><img src="/img/naire/flow-e.png" data-full="/img/naire/flow-e.png" style="max-width: 150px;border-radius: 4px;"/></th>
                <td>
                  <strong>STEP 5　Delivery of products</strong><br/>
                  ＊It will be delivered in about 2-3 weeks.
                </td>
              </tr>
            </table>
          </div>
        </div>        
    </div>
    <div class="order-form" id="order-form">
      <button type="button" id="closeFormOrderMobile" onclick="closeModalOrderMobile()">
        × close
      </button>
      <h2>Simulation/ Order </h2>
       <!-- Hidden image URL field (add your actual image URL here) -->
      <input type="hidden" id="productImage" name="productImage" value="https://rakuteku.com/img/naire/oem-logo-3-desc-a.png">
      <input type="hidden" id="productName" name="productName" value="M3001">
      <label for="productN">Product model number</label>
      <input type="text" id="productN" name="productN" value="M3001" readonly style="border:none">
      <label for="bodyColor">Body Color</label>
      <select id="bodyColor" name="bodyColor">
        <option value="blackBody">black</option>
        <option value="whiteBody">white</option>
      </select>
      <label for="inkColor">ink color</label>
      <select id="inkColor" name="inkColor">
        <option value="3colorInk">black, red, blue</option>
      </select>
      <label for="lot">Order Quantity</label>
      <select id="lot" name="lot">
        <option value="50">50pcs</option>
        <option value="100">100pcs</option>
      </select>
      <p class="notice">Printing is in one color, the price shown includes shipping.</p>
      <p class="notice">Delivery to anywhere in Japan takes approximately 2-3 weeks.</p>
      <div class="totals">
        <div><span>price for 1pc each (tax included)</span><span id="unitPrice" class="amount">¥0</span></div>
        <div><span>Total(tax included)</span><span id="totalPrice" class="amount">¥0</span></div>
        <button id="orderButton" class="order-button">ORDER NOW</button>
      </div>
      <!-- Order Form (hidden by default) -->
      <div id="orderFormContainer" class="order-form-container" style="display: none;">
        <h3>Order Information</h3>
        <form id="orderForm" action="?" method="POST">
          <div class="form-group">
            <label for="name">Full Name:</label>
            <input type="text" id="name" name="name" required>
          </div>
          <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
          </div>
          <div class="form-group">
            <label for="emailConfirm">Email(confirmation):</label>
            <input type="email" id="emailConfirm" name="emailConfirm" required>
          </div>
          <div class="form-group">
            <label for="phone">Phone no (Japanese):</label>
            <input type="tel" id="phone" name="phone" required>
          </div>
          <div id="recaptcha-container"></div>
          <div class="form-buttons">
            <button type="button" id="resetForm">Cancel</button>
            <button type="submit">Send</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!--CONTACT US-->
  <div class="floating-container" style="width: 90px;height: 75px;">
    <button class="floating-btn" onclick="openModal()" >
        <img src="/img/iconPhone.png" alt="Custom Icon" style="width: 36px; height: 36px;">
        <div class="floating-text">Contact Us</div>
    </button>
  </div>
  <div class="modal" id="modal" onclick="closeModal(event)">
      <div class="modal-content" onclick="event.stopPropagation()">
          <span class="close-btn" onclick="closeModal(event)">X</span>
          <h2 style="color:white">Contact Us</h2>
          <div class="modal-body">
              <div>
                  <a href="https://line.me/ti/p/YKtb301rPt" target="_blank">
                      <img src="/img/lineqr.jpg" alt="LINE 3 Code">
                      <p>LINE</p>
                  </a>
              </div>
              <div>
                  <a href="tel:05071088235">
                    <img src="/img/iconPhone.png" alt="toiawaseDenwa" style="width: 42px; height:42px">
                      <p>05071088235</p>
                  </a>
              </div>
              <div>
                  <a href="mailto:support@rakuteku.com">
                    <img src="/img/iconEmail.png" alt="toiawaseMeru" style="width: 42px; height:42px">
                    <p>support@rakuteku.com</p>
                  </a>
              </div>
          </div>
      </div>
  </div>

    <!--ORDER MOBILE-->
    <div class="floating-container-order" style="width: 90px;height: 75px;">
      <button class="floating-btn" onclick="openModalOrder()" >
          <img src="/img/naire/iconOrder.png" alt="Custom Icon" style="width: 36px; height: 36px;">
          <div class="floating-text">Order Form</div>
      </button>
    </div>

  <!--FOOTER-->
  <footer>
    <div class="row primary" style="max-width:1080px; margin: auto;">
      <div class="column about">
        <img src="/img/logoHorizontal.png" style="max-width: 210px; margin: auto;" alt="logo" />
        <p>
          We offer high tech products at affordable prices.
          Surveillance cameras, drones, hearing aids, OEM, branding
        </p>
      </div>
      <div class="column links">  
        <h3>Quick Links</h3>
        <ul>
          <li>
            <a href="#faq">ホーム</a>
          </li>
          <li>
            <a href="#cookies-policy">会社概要
            </a>
          </li>
          <li>
            <a href="#terms-of-services">商品一覧</a>
          </li>
          <li>
            <a href="#support">お問い合わせ</a>
          </li>
        </ul>
      </div>
      <div class="column subscribe">
        <h3>Buy Now</h3>
        <div class="sns">
          <a href="https://mercari-shops.com/shops/oqSNGMDBgWxRMsXs5gzrk3" target="_blank" style="cursor: pointer;"><img src="/img/3-code-mercari-shops.png" style="max-width: 120px; margin: auto;" alt="logo" /></a>
          <a href="https://auctions.yahoo.co.jp/seller/nqmya12351" target="_blank" style="cursor: pointer;"><img src="/img/3-code-yahoo auction.png" style="max-width: 120px; margin: auto;" alt="logo" /></a>
        </div>
        <div class="social">
          <i class="fa-brands fa-facebook-square"></i>
          <i class="fa-brands fa-instagram-square"></i>
          <i class="fa-brands fa-twitter-square"></i>
        </div>
      </div>
    </div>
    <div class="row secondary" style="max-width:1080px; margin: auto;">
      <div class="custIconCont">
          <i class="custIcon" style=" background-image: url('/img/iconPhone.png'); "></i>&nbsp;+81 050-7108-8235
      </div>
      <div class="custIconCont">
        <i class="custIcon" style=" background-image: url('/img/iconEmail.png'); "></i>&nbsp;support@rakuteku.com
      </div>
      <div class="custIconCont">
        <i class="custIcon" style=" background-image: url('/img/iconAddress.png'); "></i>&nbsp;札幌市中央区南５条西１５丁目２－３－５０３
      </div>
    </div>
    <div class="row copyright">
      <p>Copyright &copy; 2025 Rakuteku | All Rights Reserved</p>
    </div>
  </footer>
  <script>
    // NAVIGATION
    const mobileNav = document.querySelector(".hamburger");
    const navbar = document.querySelector(".menubar");
    const toggleNav = () => {
      navbar.classList.toggle("active");
      mobileNav.classList.toggle("hamburger-active");
    };
    mobileNav?.addEventListener("click", toggleNav);
    document.addEventListener("click", (event) => {
      const isClickInsideMenu = navbar.contains(event.target);
      const isClickOnHamburger = mobileNav.contains(event.target);
      if (navbar.classList.contains("active") && !isClickInsideMenu && !isClickOnHamburger) {
        toggleNav();
      }
    });
  
    // NAVBAR SCROLL EFFECT
    window.addEventListener("scroll", function () {
      const nav = document.querySelector("nav");
      nav.classList.toggle("scrolled", window.scrollY > 50);
    });
  
    // IMAGE THUMBNAILS
    document.querySelectorAll('.thumbnails img').forEach(img => {
      img.addEventListener('click', () => {
        document.querySelector('.thumbnails img.active')?.classList.remove('active');
        img.classList.add('active');
        document.getElementById('mainImg').src = img.dataset.full;
      });
    });
  
    // PRICE CALCULATION
    const lotEl = document.getElementById('lot');
    const unitEl = document.getElementById('unitPrice');
    const totalEl = document.getElementById('totalPrice');
    function calc() {
      const lot = Number(lotEl.value);
      let base = (lot >= 100) ? 108 : 198;
      const unitWithTax = Math.ceil(base * 1.099);
      const totalWithTax = unitWithTax * lot;
      unitEl.textContent = `¥${unitWithTax.toLocaleString()}`;
      totalEl.textContent = `¥${totalWithTax.toLocaleString()}`;
    }
    lotEl.addEventListener('change', calc);
    calc();
  
    // FORM HANDLING
    const orderButton = document.getElementById('orderButton');
    const orderFormContainer = document.getElementById('orderFormContainer');
    const orderForm = document.getElementById('orderForm');
    const resetFormButton = document.getElementById('resetForm');
    orderButton?.addEventListener('click', () => {
      orderFormContainer.style.display = 'block';
      orderButton.style.display = 'none';
    });
    resetFormButton?.addEventListener('click', () => {
      orderFormContainer.style.display = 'none';
      orderButton.style.display = 'block';
    });
    let recaptchaWidgetId;
    orderForm.addEventListener('submit', function (e) {
      e.preventDefault();
      const email = document.getElementById('email').value;
      const emailConfirm = document.getElementById('emailConfirm').value;
      if (email !== emailConfirm) {
        alert('email does not match');
        return;
      }
      if (typeof grecaptcha === 'undefined' || recaptchaWidgetId === undefined) {
        alert('reCAPTCHA is not loading yet, please wait.');
        return;
      }
      const recaptchaToken = grecaptcha.getResponse(recaptchaWidgetId);
      if (!recaptchaToken) {
        alert('Check the reCAPTCHA');
        return;
      }
      const formData = {
        product: document.getElementById('productName').value,
        bodyColor: document.getElementById('bodyColor').value,
        inkColor: document.getElementById('inkColor').value,
        lot: lotEl.value,
        totalPrice: totalEl.textContent,
        productImage: document.getElementById('productImage').value,
        name: document.getElementById('name').value,
        email: email,
        phone: document.getElementById('phone').value,
        timestamp: new Date().toISOString(),
        recaptchaToken: recaptchaToken
      };
      submitToGoogleSheets(formData);
    });
  
    // GOOGLE SHEETS SUBMISSION
    async function submitToGoogleSheets(formData) {
    const scriptURL = 'https://script.google.com/macros/s/AKfycby6n31OHL4ksCMYLArrL6KM1_7ZIMN1PVMp26f5MbUCR79yn7K_aeOY10gYca0ws1RL8g/exec';
    const submitBtn = document.querySelector('#orderForm [type="submit"]');
    try {
        submitBtn.disabled = true;
        submitBtn.textContent = "sending...";
        const response = await fetch(scriptURL, {
          method: "POST",
          redirect: "follow",
          headers: {
            "Content-Type": "text/plain;charset=utf-8"  // <-- WORKAROUND for CORS
          },
          body: JSON.stringify(formData)
        });
        const result = await response.json();

        if (result.status !== "success") {
          throw new Error(result.message || "送信エラー");
        }
        alert('Submission was successful! Please check the automatically sent email you will receive.');
        orderForm.reset();
        orderFormContainer.style.display = 'none';
        orderButton.style.display = 'block';
        grecaptcha.reset();
      } catch (error) {
        console.error("Error:", error);
        alert(`送信失敗: ${error.message}`);
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = "送信";
      }
    }
  
    // reCAPTCHA CALLBACKS
    function onRecaptchaLoad() {
      if (!document.getElementById('recaptcha-container')) {
        console.error("reCAPTCHA container not found");
        return;
      }
      recaptchaWidgetId = grecaptcha.render('recaptcha-container', {
        sitekey: '6Lfw4kArAAAAAMNcWWBg1U5F7HhE8Thq2Z7sCKUz',
        callback: onRecaptchaSuccess,
        'expired-callback': onRecaptchaExpired
      });
      console.log("reCAPTCHA rendered:", recaptchaWidgetId);
    }
    function onRecaptchaSuccess(token) {
      console.log("reCAPTCHA verified:", token);
    }
    function onRecaptchaExpired() {
      console.log("reCAPTCHA expired");
      grecaptcha.reset(recaptchaWidgetId);
    }
  </script>
  
  <!-- Load reCAPTCHA API (ONCE) -->
  <script src="https://www.google.com/recaptcha/api.js?onload=onRecaptchaLoad&render=explicit" async defer></script>
  
  <!--tab-->
  <script>
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabContents = document.querySelectorAll('.tab-content');
    tabButtons.forEach(button => {
      button.addEventListener('click', () => {
        tabButtons.forEach(btn => btn.classList.remove('active'));
        tabContents.forEach(content => content.classList.remove('active'));
        button.classList.add('active');
        document.getElementById(button.dataset.tab).classList.add('active');
      });
    });

    function openModal() {
      document.getElementById("modal").style.display = "flex";
      toggleNav();
    }
    function closeModal(event) {
      document.getElementById("modal").style.display = "none";
    }

    function openModalOrder() {
      document.getElementById("order-form").style.display = "block";
      toggleNav();
    }
    function closeModalOrderMobile() {
      document.getElementById("order-form").style.display = "none";
    }
  </script>
  
</body>
</html>